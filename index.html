<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="都会好的  总会有的">
<meta property="og:type" content="website">
<meta property="og:title" content="Dunteng&#39;s Blog">
<meta property="og:url" content="https://dunteng.github.io/index.html">
<meta property="og:site_name" content="Dunteng&#39;s Blog">
<meta property="og:description" content="都会好的  总会有的">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dunteng&#39;s Blog">
<meta name="twitter:description" content="都会好的  总会有的">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'GX48388M0Z',
      apiKey: '24910416df90ea04217402b818109cef',
      indexName: 'index',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://dunteng.github.io/">





  <title>Dunteng's Blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dunteng's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/08/09/博客项目01.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/08/09/博客项目01.html" itemprop="url">一、博客项目大作战之数据库建表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-09T00:00:00+08:00">
                2019-08-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h2><p><img src="https://pic3.zhimg.com/v2-56d60579638b9a59ede77fb0fa3ecd2a_r.jpg" alt=""></p>
<p><br></p>
<h2 id="持久层之数据库建表"><a href="#持久层之数据库建表" class="headerlink" title="持久层之数据库建表"></a>持久层之数据库建表</h2><p>创建数据库<strong>my_blog</strong>👇</p>
<p><img src="https://pic3.zhimg.com/v2-5cc8b67e76935f8d3ac1152b3835f902_r.jpg" alt=""></p>
<p><br></p>
<p>创建表<strong>blog</strong>👇</p>
<p>用于存储博客文章，特别注意要设置编码格式为<strong>utf8mb4</strong>，否则emoji无法正常显示。</p>
<p><code>views</code>为文章浏览次数，<code>ctime</code>为创建时间，<code>utime</code>为修改时间。</p>
<p><img src="https://pic4.zhimg.com/v2-c29c1a6cfbae94644e9e9be24fc76467_r.jpg" alt=""></p>
<p>设置表的索引👇</p>
<p><img src="https://pic3.zhimg.com/v2-2e8103ce4cd64220a21c6fd873fc0cfe_r.jpg" alt=""></p>
<p><br></p>
<p>创建表<strong>every_day</strong>👇</p>
<p><img src="https://pic4.zhimg.com/v2-b6b7376a12907be6eecf759fd2f2af77_r.jpg" alt=""></p>
<p>设置索引👇</p>
<p><img src="https://pic3.zhimg.com/v2-0f8fc5b1803ee14ddee30b2941e9f172_r.jpg" alt=""></p>
<p><br></p>
<p>创建表tags👇</p>
<p><img src="https://pic2.zhimg.com/v2-2e9839df691ec4ea2714bd28a9968fed_r.jpg" alt=""></p>
<p>设置索引👇</p>
<p><img src="https://pic1.zhimg.com/v2-1f699976957e423bc457d1251d4f1c84_r.jpg" alt=""></p>
<p><br></p>
<p>创建表tag_blog_mapping（tags和blog之间的映射表）👇</p>
<p><img src="https://pic3.zhimg.com/v2-0da154a08d9edc56cd79313b5ed2419e_r.jpg" alt=""></p>
<p>设置索引👇</p>
<p><img src="https://pic2.zhimg.com/v2-57572abfa8a419ba3b66a943cb10bb89_r.jpg" alt=""></p>
<p><br></p>
<p>创建表comments👇</p>
<p><img src="https://pic4.zhimg.com/v2-4d74bfe8b3e17764cdb3f9b169adf35f_r.jpg" alt=""></p>
<p>设置索引👇</p>
<p><img src="https://pic2.zhimg.com/v2-56e73521abea3d3b2fe61889ff4f082d_r.jpg" alt=""></p>
<p><br><br></p>
<p>博客项目的数据库表基本创建完成。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/11/23/小程序云函数路由优化之tcb-router.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/11/23/小程序云函数路由优化之tcb-router.html" itemprop="url">小程序云函数路由优化之tcb-router</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-23T00:00:00+08:00">
                2019-11-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>一个用户在一个云环境中只能创建50个云函数，之前是20个，更少。</p>
<p>比如我们要开发一个项目，当我们要获取A数据的时候可能要创建一个云函数，要获取B数据的时候又要创建一个云函数。。。。随着业务的增多，创建的对应的云函数数目越来越多，50个可能不够用，而且这种做法也很冗杂。</p>
<p>所以希望把相似的请求归类到同一个云函数处理，比如我们把获取音乐信息和获取电影信息都在同一个云函数里实现，从而避免创建过多云函数的情况。</p>
<p>要实现这一功能就要用到一个第三方库——<a href="https://github.com/TencentCloudBase/tcb-router" target="_blank" rel="noopener"><strong>tcb-router</strong></a> 一个<strong>koa风格</strong>的云函数路由库。</p>
<p><br></p>
<h2 id="koa洋葱模型"><a href="#koa洋葱模型" class="headerlink" title="koa洋葱模型"></a>koa洋葱模型</h2><p>koa框架采用了【中间件】的形式，中间件可以介入请求和相应的处理，可以理解是一个轻量级的模块，或者在我们的代码当中是一个函数形式。中间件可以负责一个特定的功能，通过一个<code>next</code>函数把每个中间件之间建立关系。</p>
<p>什么是【洋葱模型】？</p>
<p><img src="https://ask.qcloudimg.com/http-save/yehe-1000017/uuitxvbg4y.jpeg?imageView2/2/w/1620" alt=""></p>
<p><img src="https://images0.cnblogs.com/blog2015/570057/201507/281409123445079.jpg" alt=""></p>
<p>简单的理解就如上面两张图所表示的那样。</p>
<p><br></p>
<h2 id="tcbRouter云函数"><a href="#tcbRouter云函数" class="headerlink" title="tcbRouter云函数"></a>tcbRouter云函数</h2><p>这里我通过一个例子来说明一下<a href="https://github.com/TencentCloudBase/tcb-router" target="_blank" rel="noopener"><strong>tcb-router</strong></a>的用法。</p>
<p>我们实现一个功能：把获取音乐信息和获取电影信息都在同一个云函数里实现，两者都要获取<code>用户openid</code>并且获取各自的信息，从而避免创建多个云函数的情况。</p>
<p>创建云函数<code>tcbRouter</code>👇</p>
<p><img src="https://pic3.zhimg.com/80/v2-889713697407a747e014aeadc142866a_hd.jpg" alt=""></p>
<p>在tcbRouter云函数的目录下安装tcb-router依赖👇</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save tcb-router</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>云函数<strong>tcbRouter</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"><span class="comment">// 引入tcb-router</span></span><br><span class="line"><span class="keyword">const</span> TcbRouter = <span class="built_in">require</span>(<span class="string">'tcb-router'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// return &#123;event,context&#125;  //看看event和context到底是啥</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// new一个TcbRouter对象,需要传入一个参数,把event传入</span></span><br><span class="line">  <span class="comment">// 这时候tcb-router就会自动帮我们处理事件中的参数和路由转发</span></span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">new</span> TcbRouter(&#123;event&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 公共路由</span></span><br><span class="line">  <span class="comment">// app.use 表示该中间件会适用于所有的路由</span></span><br><span class="line">  app.use(<span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入全局中间件'</span>)</span><br><span class="line">    ctx.data = &#123;&#125;</span><br><span class="line">    ctx.data.openId = event.userInfo.openId <span class="comment">//通过该公共路由获取到用户openid</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件.这是一个异步操作,要加上await</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出全局中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// music相关的路由</span></span><br><span class="line">  app.router(<span class="string">'music'</span>, <span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入音乐名称路由中间件'</span>)</span><br><span class="line">    ctx.data.musicName = <span class="string">"Let it be"</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出音乐名称路由中间件'</span>)</span><br><span class="line">  &#125;, <span class="keyword">async</span> (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入音乐类型路由中间件'</span>)</span><br><span class="line">    ctx.data.musicType = <span class="string">'摇滚乐'</span></span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      data: ctx.data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctx.body 返回数据到小程序端</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出音乐类型路由中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// movie相关的路由</span></span><br><span class="line">  app.router(<span class="string">'movie'</span>, <span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入电影名称路由中间件'</span>)</span><br><span class="line">    ctx.data.movieName = <span class="string">"千与千寻"</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出电影名称路由中间件'</span>)</span><br><span class="line">  &#125;, <span class="keyword">async</span> (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入电影类型路由中间件'</span>)</span><br><span class="line">    ctx.data.movieType = <span class="string">'动漫'</span></span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      data: ctx.data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctx.body 返回数据到小程序端</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出电影类型路由中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// // 必须写! 需要把当前的服务返回</span></span><br><span class="line">  <span class="keyword">return</span> app.serve()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>小程序端调用tcbRouter函数👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo.js</span></span><br><span class="line">getMusicInfo()&#123;</span><br><span class="line">   wx.cloud.callFunction(&#123;</span><br><span class="line">     name: <span class="string">'tcbRouter'</span>,</span><br><span class="line">     data: &#123;</span><br><span class="line">       $url: <span class="string">'music'</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(res)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br><span class="line"> getMovieInfo()&#123;</span><br><span class="line">   wx.cloud.callFunction(&#123;</span><br><span class="line">     name: <span class="string">'tcbRouter'</span>,</span><br><span class="line">     data:&#123;</span><br><span class="line">       $url: <span class="string">'movie'</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(res)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
<p>上面这段代码两个方法实际上调用的都是同一个云函数<strong>tcbRouter</strong>，但实现了不同的功能。</p>
<p><img src="https://pic1.zhimg.com/v2-928c9ce713a0d13a92d18d6abe21b910_r.jpg" alt=""></p>
<p><br></p>
<p>为了更加直观的体现【洋葱模型】这一概念在该例子上的应用，我们可以在云开发控制台的云函数运行日志中查看打印的日志👇</p>
<p><img src="https://pic3.zhimg.com/v2-0484ed79f891b5e7b2e82ad95296e6ca_r.jpg" alt=""></p>
<p><img src="https://images0.cnblogs.com/blog2015/570057/201507/281409123445079.jpg" alt=""></p>
<p><br><br><br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/28/对象.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/28/对象.html" itemprop="url">复习对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-28T00:00:00+08:00">
                2019-10-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="对象创建方法"><a href="#对象创建方法" class="headerlink" title="对象创建方法"></a>对象创建方法</h2><ul>
<li><p>对象字面量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>系统自带的构造函数Object()</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义构造函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与普通函数区别：1、函数名大驼峰命名；2、定义属性和方法为纯语句</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Teacher</span>(<span class="params">name, sex</span>) </span>&#123; <span class="comment">// 传入参数-单个属性</span></span><br><span class="line">    <span class="comment">// 当没有经过关键字new构造函数，就还没有实例化，此时this不存在</span></span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">25</span>; <span class="comment">// 默认属性</span></span><br><span class="line">    <span class="keyword">this</span>.smoke = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'I am smoking'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> teacher = <span class="keyword">new</span> Teacher(<span class="string">'dunteng'</span>,<span class="string">'male'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Object.create()创建对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">"xiaoming"</span>,</span><br><span class="line">  age: <span class="number">18</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 将obj作为obj1的原型</span></span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="built_in">Object</span>.create(obj)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br></p>
<h2 id="构造函数的内部原理"><a href="#构造函数的内部原理" class="headerlink" title="构造函数的内部原理"></a>构造函数的内部原理</h2><ol>
<li>在函数体最前面隐式地加上<code>this={}</code></li>
<li>执行<code>this.xxx = xxx;</code></li>
<li>隐式地返回<code>this</code></li>
</ol>
<p>构造函数能构造出对象的前提是要new它！从而触发构造函数的内部原理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,height</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// var this =&#123;&#125;</span></span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.say);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// return this</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'xiaolin'</span>,<span class="number">180</span>);</span><br></pre></td></tr></table></figure>
<p>⚠来点捣乱的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, height</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.say);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;&#125;;<span class="comment">//返回一个空对象</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'xiaolin'</span>, <span class="number">180</span>);</span><br></pre></td></tr></table></figure>
<p>结果person的值就变成了return出来的空对象。</p>
<p>在构造函数内部允许显示地return出一个对象（空对象也好其他对象也好），则new出来的实例结果就是对应的对象。⚠但是如果是显示return出数字、字符串、undefined或者null，即return的是五大原始值，则new出实例的时候仍然是return语句前面构造出来的this对象！</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570849572989.png" alt="1570849572989"></p>
<p><br><br></p>
<h2 id="包装类"><a href="#包装类" class="headerlink" title="包装类"></a>包装类</h2><p><strong>原始值是不能有属性和方法的</strong>。</p>
<p>看下面👇</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850068707.png" alt="1570850068707"></p>
<p>这里的num依然是数字，但是它是用<strong>包装类</strong>Number new出来的数字对象，那么<strong>它就可以加属性和方法</strong>。同时它依旧可以运算，但是运算结果是原始值的数字。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850243772.png" alt="1570850243772"></p>
<p>同样的也有:</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850309748.png" alt="1570850309748"></p>
<p>前面说了原始值不能有属性和方法，那么看下面的栗子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">4</span>;</span><br><span class="line">num.len = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(num.len);</span><br></pre></td></tr></table></figure>
<p>打印结果为undefined，也不报错。原因是存在包装类的隐式调用，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">4</span>;</span><br><span class="line">num.len = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// 原始值是不能有属性和方法的，但是在这里系统会自动执行：new Number(num).len = 3以避免报错</span></span><br><span class="line"><span class="comment">// 但随即又delete自己。即刚new完Number随机就把自己删了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后在console.log(num.len)的时候，讲道理num.len已经不存在了会报错的</span></span><br><span class="line"><span class="comment">// 但是系统为了避免报错又隐式地执行了new Number(num).len，所以结果为输出undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(num.len);</span><br></pre></td></tr></table></figure>
<p><br></p>
<hr>

<p>对于数组，有以下的可行操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">arr.length = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr);<span class="comment">//[1,2]</span></span><br></pre></td></tr></table></figure>
<p>数组是可以通过length来截断的，但字符串不行！</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"1234"</span>;</span><br><span class="line">str.length = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str);<span class="comment">//"1234"</span></span><br></pre></td></tr></table></figure>
<p>分析：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"1234"</span>;</span><br><span class="line">str.length = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 执行到str.length = 2的时候系统隐式地执行了new Number(str).length=2,</span></span><br><span class="line"><span class="comment">// 以避免报错，但随机就销毁了</span></span><br><span class="line"><span class="built_in">console</span>.log(str);<span class="comment">//"1234"</span></span><br><span class="line"><span class="comment">// 执行console.log(str.length)的时候系统隐式地执行了new Number(str).length，</span></span><br><span class="line"><span class="comment">// 而length是String类型内置的属性，可以访问</span></span><br><span class="line"><span class="built_in">console</span>.log(str.length);<span class="comment">//4</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<hr>

<p><strong>来练练</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"abc"</span>;</span><br><span class="line">str += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> test = <span class="keyword">typeof</span> (str);</span><br><span class="line"><span class="keyword">if</span> (test.length == <span class="number">6</span>) &#123;</span><br><span class="line">  test.sign = <span class="string">"hello world"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(test.sign);</span><br></pre></td></tr></table></figure>
<p>分析如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"abc"</span>;</span><br><span class="line">str += <span class="number">1</span>;  <span class="comment">//str变成了"abc1"</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="keyword">typeof</span> (str);  <span class="comment">//test为"string"</span></span><br><span class="line"><span class="keyword">if</span> (test.length == <span class="number">6</span>) &#123;</span><br><span class="line">  test.sign = <span class="string">"hello world"</span>;<span class="comment">//test是字符串，原始值不能有属性，隐式地执行</span></span><br><span class="line">  <span class="comment">//new Number(test).sign="hello world"，随即销毁</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//隐式地执行包装类转换：new Number(test).sign，随即销毁</span></span><br><span class="line"><span class="built_in">console</span>.log(test.sign);<span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>同闭包知识点结合的一题👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, sex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sss</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    a++;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.say = sss;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line">person1.say();</span><br><span class="line">person1.say();</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</span><br><span class="line">person2.say();</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="原型prototype"><a href="#原型prototype" class="headerlink" title="原型prototype"></a>原型prototype</h2><ul>
<li><p>定义： 原型是function对象的一个属性，它定义了构造函数制造出的对象的公共祖先。通过该构造函数产生的对象，可以继承原型的属性和方法。原型也是对象。</p>
</li>
<li><p>利用原型特点和概念，可以提取共有属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Car.prototype.height = <span class="number">1400</span>;</span><br><span class="line">Car.prototype.lang = <span class="number">4900</span>;</span><br><span class="line">Car.prototype.carName = <span class="string">"BMW"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">color, owner</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.owner = owner;</span><br><span class="line">  <span class="keyword">this</span>.color = color;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> Car(<span class="string">'red'</span>, <span class="string">'dunteng'</span>)</span><br><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> Car(<span class="string">'pink'</span>, <span class="string">'xiaolin'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象如何查看原型   通过隐式属性<code>__proto__</code></p>
<p>​    访问对象实例的属性的时候，先查看实例对象自己有没有，没有的话就通过它的隐式属性<code>__proto__</code>查看原型里有没有这个属性。</p>
<p>💡  <code>对象实例.__proto__</code>全等于<code>对象构造函数.prototype</code></p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570862901392.png" alt="1570862901392"></p>
</li>
</ul>
<p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570863065304.png" alt="1570863065304"></p>
<ul>
<li><p>对象如何查看对象的构造函数   通过<code>constructor</code></p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570863239261.png" alt="1570863239261"></p>
<p>constructor存在于原型中。</p>
</li>
</ul>
<p><br><hr></p>
<p>看典例👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.name = <span class="string">"sunny"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">"jenny"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"jenny"</span></span><br></pre></td></tr></table></figure>
<p>上面这个很容易理解，但下面改一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.name = <span class="string">"sunny"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="comment">// 在new的时候存在一个隐式过程👇</span></span><br><span class="line"><span class="comment">// function Person() &#123;</span></span><br><span class="line"><span class="comment">// var this = &#123;</span></span><br><span class="line"><span class="comment">//   __proto__: Person.prototype   用__proto__记录了Person.prototype的地址</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="string">'jenny'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 将Person.prototype重新指向了一个新的空间，而person作为new出来的实例是通过__proto__查找</span></span><br><span class="line"><span class="comment">// 原型的，__proto__中记录的东西并没有改变，仍指向原来的Person.prototyped空间</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>原型也有自己的原型，就形成了原型链。原型链的终端是Object.prototype。可以说<strong>绝大多数</strong>对象的最终都会继承自Object.prototype。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GrandFather.prototype.lastName = <span class="string">"wang"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GrandFather</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"祖父"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> grandfather = <span class="keyword">new</span> GrandFather();</span><br><span class="line"></span><br><span class="line">Father.prototype = grandfather;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"父亲"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br><span class="line"></span><br><span class="line">Son.prototype = father;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"儿子"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br><span class="line"><span class="built_in">console</span>.log(son.lastName);<span class="comment">//"wang"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570865370449.png" alt="1570865370449"></p>
<hr>

<p>前面有提到【绝大多数的对象最终都继承自Object.prototype】，那么什么对象例外呢？</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570866805009.png" alt="1570866805009"></p>
<hr>

<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570867335732.png" alt="1570867335732"></p>
<p>原始值的123是没有方法的，所以要用包装类包装成Number类型，再调用toString方法，注意这里的toString方法是Number()自己重写的，不是Object()的toString，Object()的toString()打印出来的是<code>[Object, Object]</code></p>
<p><br><br></p>
<h2 id="call-apply"><a href="#call-apply" class="headerlink" title="call/apply"></a>call/apply</h2><p>作用： 都能改变<code>this</code>指向</p>
<p>区别： 后面传递的参数形式不同</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person(<span class="string">'lin'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="comment">// 这里直接调用Person函数就没把它当作构造函数new了，里面的this就指向全局window</span></span><br><span class="line"><span class="built_in">console</span>.log(name);</span><br><span class="line"><span class="built_in">console</span>.log(age);</span><br></pre></td></tr></table></figure>
<p>这里说一下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test()实际上是test.call()</span><br></pre></td></tr></table></figure>
<p>使用<code>call</code>改变this指向：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">Person.call(obj, <span class="string">'lin'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj);<span class="comment">//obj里面age为18，name为lin</span></span><br></pre></td></tr></table></figure>
<p>这里使用call将this的指向改变成了obj，或者说这里就把对象<code>obj</code>拿来取代了this，或者说this就成了obj。</p>
<p>来个应用栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, sex, tel, grade</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  <span class="keyword">this</span>.tel = tel;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> student = <span class="keyword">new</span> Student(<span class="string">'lin'</span>, <span class="number">18</span>, <span class="string">'male'</span>, <span class="number">137</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p>这样<strong>代码太冗余</strong>了，用call方法改进一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, sex, tel, grade</span>) </span>&#123;</span><br><span class="line">  Person.call(<span class="keyword">this</span>, name, age, sex)</span><br><span class="line">    <span class="comment">//上面结束后实际上 就有一个 this = &#123;name:'lin',age:'18',sex:'male' &#125; </span></span><br><span class="line">  <span class="keyword">this</span>.tel = tel;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> student = <span class="keyword">new</span> Student(<span class="string">'lin'</span>, <span class="number">18</span>, <span class="string">'male'</span>, <span class="number">137</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>call需要把实参按照形参的个数一个个传进去，</p>
<p>apply需要传入一个实参数组</p>
<p>再来个栗子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wheel</span>(<span class="params">WheelSize, style</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.WheelSize = WheelSize;</span><br><span class="line">  <span class="keyword">this</span>.style = style;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sit</span>(<span class="params">c, sitColor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.c = c;</span><br><span class="line">  <span class="keyword">this</span>.sitColor = sitColor</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Model</span>(<span class="params">height, width, len</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.width = width;</span><br><span class="line">  <span class="keyword">this</span>.len = len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">WheelSize, style, c, sitColor, height, width, len</span>) </span>&#123;</span><br><span class="line">  Wheel.apply(<span class="keyword">this</span>, [WheelSize, style]);</span><br><span class="line">  Sit.apply(<span class="keyword">this</span>, [c, sitColor]);</span><br><span class="line">  Model.apply(<span class="keyword">this</span>, [height, width, len])</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myCar = <span class="keyword">new</span> Car(<span class="number">100</span>, <span class="string">'花里胡哨'</span>, <span class="string">'真皮'</span>, <span class="string">'red'</span>, <span class="number">1800</span>, <span class="number">1900</span>, <span class="number">4900</span>)</span><br><span class="line"><span class="built_in">console</span>.log(myCar);</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>继承发展史：</p>
<ol>
<li><p>原型链</p>
<p>缺点：过多的继承了没用的属性<br></p>
</li>
<li><p>借用构造函数+call/apply</p>
<p>我上面讲call/apply的两个栗子就是</p>
<p>缺点：无法继承借用来的构造函数的原型，而且不方便。<br></p>
</li>
<li><p>共有原型</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Father.prototype.lastName = <span class="string">"xi"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">  Target.prototype = Origin.prototype;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">inherit(Son, Father);<span class="comment">//一定要先继承再定义哦</span></span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br></pre></td></tr></table></figure>
<p>这种做法有<strong>缺点</strong>，如果想要给Son对象的原型添加些属性，那么很不好的事，Father对象并不需要这些属性，因为要知道，它俩的原型指向的是同一个。<br></p>
</li>
<li><p>圣杯模式 </p>
<p>借用一个中间层。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  F.prototype = Origin.prototype;<span class="comment">//这行和下一行顺序一定不能调换，否则就错了</span></span><br><span class="line">  Target.prototype = <span class="keyword">new</span> F();  <span class="comment">//F作为中间层，这样就算Target会修改原型，也只是修改了F，影响不到Origin</span></span><br><span class="line">  Target.prototype.constructor = Target;  <span class="comment">//手动添加构造器constructor</span></span><br><span class="line">  Target.prototype.uber = Origin.prototype; <span class="comment">//记录真实的原型</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">Father.prototype = &#123;</span><br><span class="line">  lastName: <span class="string">'Lin'</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">inherit(Son, Father);</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br><span class="line"><span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570887149405.png" alt="1570887149405"></p>
<p>上面这个继承还可以再优化一下，使用立即执行函数和闭包来优化：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">var</span> inherit = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">       F.prototype = Origin.prototype;</span><br><span class="line">       Target.prototype = <span class="keyword">new</span> F();</span><br><span class="line">       Target.prototype.constructor = Target;</span><br><span class="line">       Target.prototype.uber = Origin.prototype;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;())<span class="comment">//整个是一个立即执行函数，即用即销毁，优化性能</span></span><br><span class="line"><span class="comment">//inherit里面的F通过闭包保存成了inherit的私有化属性，更加优化</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">   Father.prototype = &#123;</span><br><span class="line">     lastName: <span class="string">'lin'</span></span><br><span class="line">   &#125;</span><br><span class="line">   inherit(Son, Father)</span><br><span class="line">   <span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br><span class="line">   <span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><br><br></p>
<h2 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h2><p>管理变量，防止污染全局，适用于模块化开发。</p>
<p>传统的方法是用对象包起来形成专有的命名空间，用的时候就通过xxx.xxxx.xxx这样的方式访问。</p>
<p>解决方式：使用<strong>立即执行函数和闭包</strong></p>
<p>栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">var</span> init = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> name = <span class="string">'abc'</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">callName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(name);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       callName();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> _init = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> name = <span class="string">'def'</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">callName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(name);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       callName();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)()</span><br><span class="line">   </span><br><span class="line">   init();</span><br><span class="line">_init();</span><br></pre></td></tr></table></figure>
<p>上面这两个函数变量命名互不影响，因为都存在于立即执行函数里面，而变量被闭包保存return带出来。<strong>实现模块开发，防止污染全局变量</strong></p>
<p><br><br></p>
<h2 id="对象的遍历"><a href="#对象的遍历" class="headerlink" title="对象的遍历"></a>对象的遍历</h2><p>对象遍历不可能像遍历数组那样for循环，因为根本不知道对象的“长度”</p>
<p>所以要使用<code>for key in obj</code>的方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj[key]);<span class="comment">//这里的每一个key本身都是String类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们知道<code>obj.xxx</code>和<code>obj[&#39;xxx&#39;]</code>都可以访问到对象属性，但是在<code>for key in obj</code>循环里必须十一用<code>obj[&#39;xxx&#39;]</code>的方式访问，<code>obj.xxx</code>输出的为undefined</p>
<p><code>obj.name</code>实际上本质会先转化为<code>obj[&#39;name&#39;]</code>，索引框里必须是字符串类型。</p>
<p>在上面代码中如果使用<code>obj.xxx</code>的方式的话：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj.key);<span class="comment">//这里变成了obj['key'],可是obj中没有key这个键，所以undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>

<p><code>for key in obj</code>可以遍历出原型里的东西吗？答案是可以的（除了Object.prototype）。</p>
<p>但是我就只想遍历出目标对象自己的属性，怎么做？</p>
<p><strong>利用<code>hasOwnProperty(xxx)</code>方法来判断<code>xxx</code>是不是obj自身的属性。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span>,</span><br><span class="line">  __proto__: &#123;</span><br><span class="line">    hobby: <span class="string">"guitar"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj[key]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>除了<code>hasOwnProperty()</code>可以判断是不是属性，<code>in</code>也可以。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'height'</span> <span class="keyword">in</span> obj);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hobby'</span> <span class="keyword">in</span> obj);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>⚠注意：<code>hasOwnProperty()</code>是判断是不是对象自己的非继承属性，<code>in</code>指判断是不是属性，不管是不是继承来的。</p>
<p><br></p>
<p>💡再来说说<code>instanceof</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A <span class="keyword">instanceof</span> B</span><br></pre></td></tr></table></figure>
<p>它的语法理解就是：</p>
<p>​    看A对象是不是B构造函数构造出来的</p>
<p>​    更深层次的理解是看A对象的原型链上有没有B的原型</p>
<p>应用：判断一个变量是数组还是对象？</p>
<p>方法一：看constructor</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897037168.png" alt="1570897037168"></p>
<p>方法二：用instanceof</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897168419.png" alt="1570897168419"></p>
<p>方法三：看toString()</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897447379.png" alt="1570897447379"></p>
<p><br><br></p>
<h2 id="this"><a href="#this" class="headerlink" title="this"></a>this</h2><ul>
<li><p>函数预编译过程中  this—&gt;window</p>
</li>
<li><p>全局作用域里  this—&gt;window</p>
</li>
<li><p>call/apply可以改变函数运行时this的指向</p>
</li>
<li><p>obj.func();   func()里面的this指向obj；即谁调用this就指向谁</p>
</li>
</ul>
<p><br></p>
<p>这里补充一下预编译：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="number">123</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570903506616.png" alt="1570903506616"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="number">123</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570903422900.png" alt="1570903422900"></p>
<p>例题👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"222"</span>;</span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">"111"</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fun = a.say;</span><br><span class="line">fun()</span><br><span class="line">a.say()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = &#123;</span><br><span class="line">  name: <span class="string">"333"</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params">fun</span>) </span>&#123;</span><br><span class="line">    fun()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">b.say(a.say);</span><br><span class="line">b.say = a.say;</span><br><span class="line">b.say();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="number">234</span>;<span class="comment">//this指向全局window</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo);</span><br><span class="line">&#125;</span><br><span class="line">pr();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="number">234</span>;<span class="comment">//this指向Object.create(pr.prototype)</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo);<span class="comment">//123</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.foo);<span class="comment">//234</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> pr();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a = <span class="number">0</span>;</span><br><span class="line">  alert(a);</span><br><span class="line">  alert(<span class="keyword">this</span>.a);</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  alert(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();<span class="comment">//0  5  0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a = <span class="number">0</span>;</span><br><span class="line">  alert(a);</span><br><span class="line">  alert(<span class="keyword">this</span>.a);</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  alert(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> test();<span class="comment">//0  undefined  0</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="arguments-callee和function-caller"><a href="#arguments-callee和function-caller" class="headerlink" title="arguments.callee和function.caller"></a>arguments.callee和function.caller</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570931723015.png" alt="1570931723015"></p>
<p><strong>callee</strong> 是 <code>arguments</code> 对象的一个属性。它可以用于引用该函数的函数体内当前正在执行的函数。这在函数的名称是未知时很有用，例如在没有名称的函数表达式 (也称为“匿名函数”)内。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//求阶乘</span></span><br><span class="line">    <span class="keyword">var</span> num = (<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">arguments</span>.callee(n - <span class="number">1</span>) * n</span><br><span class="line">    &#125;)(<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<hr>

<p>来说说<strong>Function.caller</strong>。</p>
<p>如果一个函数<code>f</code>是在全局作用域内被调用的,则<code>f.caller为`</code>null<code>,相反,如果一个函数是在另外一个函数作用域内被调用的,则</code>f.caller指向调用它的那个函数.`</p>
<p>⚠该特性是非标准的，官方建议不要再生产环境中使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller);</span><br><span class="line">&#125;</span><br><span class="line">test1();</span><br><span class="line"><span class="comment">//执行结果为null</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  test2()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller === test1);</span><br><span class="line">&#125;</span><br><span class="line">test1();</span><br><span class="line"><span class="comment">//执行打印结果为test1函数体和true</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="浅克隆-深克隆"><a href="#浅克隆-深克隆" class="headerlink" title="浅克隆/深克隆"></a>浅克隆/深克隆</h2><p>【浅克隆】</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'abc'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sex: <span class="string">'male'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">origin, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = target || &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> origin) &#123;</span><br><span class="line">    target[key] = origin[key]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> newObj = clone(obj);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570935515334.png" alt="1570935515334"></p>
<p>浅克隆的原始值属性更改，另一个对象不受影响。但是引用值属性一改就全都改了。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570936074035.png" alt="1570936074035"></p>
<p>为了避免这个问题就需要进行<strong>深度克隆</strong></p>
<p>思想：</p>
<ol>
<li>遍历对象  <code>for (var prop in origin)</code></li>
<li>判断是不是原始值 ，同时排除null。 <code>origin[prop] !== null &amp;&amp; typeof (origin[prop]) == &#39;object&#39;</code></li>
<li>判断是数组还是对象，利用<code>Object.prototype.toStringcall(origin[prop])</code>方法</li>
<li>建立相应的数组或对象</li>
<li>递归</li>
</ol>
<p><br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">  name: <span class="string">'zhang'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sex: <span class="string">'male'</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="number">666</span>); &#125;,</span><br><span class="line">  children: &#123;</span><br><span class="line">    first: &#123;</span><br><span class="line">      name: <span class="string">'zhang2'</span>,</span><br><span class="line">      age: <span class="number">11</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  car: [<span class="string">'Benz'</span>, <span class="string">'Mazda'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = deepClone(person1);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">origin, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = target || &#123;&#125;,</span><br><span class="line">    toStr = <span class="built_in">Object</span>.prototype.toString,</span><br><span class="line">    arrStr = <span class="string">"[object Array]"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> origin) &#123;</span><br><span class="line">    <span class="keyword">if</span> (origin.hasOwnProperty(prop)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (origin[prop] !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> (origin[prop]) == <span class="string">'object'</span>) &#123;</span><br><span class="line">        target[prop] = toStr.call(origin[prop]) == arrStr ? [] : &#123;&#125;;</span><br><span class="line">        deepClone(origin[prop], target[prop]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        target[prop] = origin[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>💡另外还可以使用 JSON 来实现深度克隆：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="built_in">JSON</span>.stringify(person1);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="built_in">JSON</span>.parse(str);</span><br></pre></td></tr></table></figure>
<p>但是json克隆无法克隆方法</p>
<p>haikyi</p>
<p><br></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/28/复习数组.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/28/复习数组.html" itemprop="url">复习数组</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-28T00:00:00+08:00">
                2019-10-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>可以先看一下这里的总结👉<a href="https://www.jianshu.com/p/9521594710d7" target="_blank" rel="noopener">点击</a></p>
<h2 id="数组创建方法"><a href="#数组创建方法" class="headerlink" title="数组创建方法"></a>数组创建方法</h2><ul>
<li><p>字面量定义方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>new Array</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>);<span class="comment">//创建了长度为10的稀松数组，值都为undefined</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>); <span class="comment">//创建了数组[1,2,3,4]</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10.2</span>)<span class="comment">//报错，长度不能为小数</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br></p>
<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><p>【会改变原数组的方法】</p>
<ul>
<li><p>push</p>
</li>
<li><p>pop</p>
</li>
<li><p>shift</p>
</li>
<li><p>unshift</p>
</li>
<li><p>reverse</p>
</li>
<li><p>splice</p>
</li>
<li><p>sort</p>
</li>
</ul>
<p>【不会改变原数组的方法】</p>
<ul>
<li>concat</li>
<li>join</li>
<li>slice</li>
<li>toString</li>
<li>join，返回字符串</li>
<li>String.split，这个不是数组的方法，它是字符串的方法。返回数组   join和split互逆</li>
</ul>
<p><strong>数组和字符串之间的相互转换就可以使用join和split</strong></p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570956573946.png" alt="1570956573946"></p>
<p>手写push方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">Array</span>.prototype.push = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">this</span>[<span class="keyword">this</span>.length] = <span class="built_in">arguments</span>[i];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.length + <span class="string">"  我是手写的push"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="built_in">console</span>.log(arr.push(<span class="number">5</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="built_in">console</span>.log(arr.push(<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>  这个splice我要特别记一下，他是这样子的👇</p>
<p>  arr.splice(从第几位开始，截取多少的长度，在切口处添加新数据)</p>
<p>  这个位数的判断很微妙，这里特别说一下，之前一直理解错</p>
<p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570954253675.png" alt="1570954253675"></p>
<p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570954293519.png" alt="1570954293519"></p>
<p>  如果是splice(-1)表示从倒数第一位置开始切。</p>
<p><br></p>
<p>sort不能直接使用，要传入一个函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">4</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure>
<p>以上是升序排序。</p>
<p>可以再简化一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a - b;<span class="comment">//升序</span></span><br><span class="line"><span class="comment">//return b - a;//降序</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>练练👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给定一个有序的数组，使其乱序</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//对象数组的排序</span><br><span class="line">var aaa = &#123;</span><br><span class="line">  age: 12,</span><br><span class="line">  name: &apos;AAA&apos;</span><br><span class="line">&#125;,</span><br><span class="line">  bbb = &#123;</span><br><span class="line">    age: 20,</span><br><span class="line">    name: &apos;BBB&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  ccc = &#123;</span><br><span class="line">    age: 6,</span><br><span class="line">    name: &apos;CCC&apos;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">var arr = [aaa, bbb, ccc];</span><br><span class="line">arr.sort(function (a, b) &#123;</span><br><span class="line">  return a.age - b.age</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(arr);</span><br></pre></td></tr></table></figure>
<p><br></p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570956085353.png" alt="1570956085353"></p>
<p><br></p>
<p>slice方法</p>
<p>slice（从该位开始截取，截取到该位），返回出截取出来的数组</p>
<p><br><br></p>
<h2 id="类数组"><a href="#类数组" class="headerlink" title="类数组"></a>类数组</h2><p>举个栗子，arguments就是个类数组。</p>
<p>手写一个类数组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">  &quot;0&quot;: &apos;a&apos;,</span><br><span class="line">  &quot;1&quot;: &apos;b&apos;,</span><br><span class="line">  &quot;2&quot;: &apos;c&apos;,</span><br><span class="line">  &quot;length&quot;: 3,</span><br><span class="line">  &quot;push&quot;: Array.prototype.push</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957073803.png" alt="1570957073803"></p>
<p>💡类数组：属性要为索引（数字）属性，必须有length属性，最好加上push方法。而且如果加上splice方法的话，外观就更像数组了👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="string">"0"</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="string">"1"</span>: <span class="string">'b'</span>,</span><br><span class="line">  <span class="string">"2"</span>: <span class="string">'c'</span>,</span><br><span class="line">  <span class="string">"length"</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">"push"</span>: <span class="built_in">Array</span>.prototype.push,</span><br><span class="line">  <span class="string">"splice"</span>: <span class="built_in">Array</span>.prototype.splice</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957380785.png" alt="1570957380785"></p>
<p>阿里巴巴笔试题👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 运行以下代码，问obj变成了什么样？</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="string">"2"</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="string">"3"</span>: <span class="string">'b'</span>,</span><br><span class="line">  <span class="string">"length"</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="string">"push"</span>: <span class="built_in">Array</span>.prototype.push,</span><br><span class="line">  <span class="string">"splice"</span>: <span class="built_in">Array</span>.prototype.splice</span><br><span class="line">&#125;</span><br><span class="line">obj.push(<span class="string">'c'</span>);</span><br><span class="line">obj.push(<span class="string">'d'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957532671.png" alt="1570957532671"></p>
<p>这里看一下push的原理就懂了，我上文有写👆</p>
<p><br></p>
<p>【封装typeof】</p>
<p>使其可以准确判断类型</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_type</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> template = &#123;</span><br><span class="line">    <span class="string">"[object Array]"</span>: <span class="string">"array"</span>,</span><br><span class="line">    <span class="string">"[object Object]"</span>: <span class="string">"object"</span>,</span><br><span class="line">    <span class="comment">// 下面三个包装类</span></span><br><span class="line">    <span class="string">"[object Number]"</span>: <span class="string">"number - object"</span>,</span><br><span class="line">    <span class="string">"[object Boolean]"</span>: <span class="string">"boolean - object"</span>,</span><br><span class="line">    <span class="string">"[object String]"</span>: <span class="string">"string - object"</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (target == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> (target) == <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="built_in">Object</span>.prototype.toString.call(target);</span><br><span class="line">    <span class="keyword">return</span> template[str];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> (target);<span class="comment">//原始值和Function可以直接通过原生typeof判断</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>【数组去重】</p>
<p>方法一：利用对象属性的唯一性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> temp = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> len = <span class="keyword">this</span>.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!temp[<span class="keyword">this</span>[i]]) &#123;</span><br><span class="line">      temp[<span class="keyword">this</span>[i]] = <span class="string">"abc"</span>;</span><br><span class="line">      arr.push(<span class="keyword">this</span>[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="built_in">console</span>.log(arr.unique());</span><br></pre></td></tr></table></figure>
<p>方法二：利用ES6的[..new Set(arr)]或者Array.from(new Set(arr))</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>,];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [...new <span class="built_in">Set</span>(arr)];</span><br><span class="line">  <span class="comment">//return Array.from(new Set(arr))  </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br></pre></td></tr></table></figure>
<p>方法三： 双循环</p>
<p>双重for（或while）循环是比较笨拙的方法，它实现的原理很简单：先定义一个包含原始数组第一个元素的数组，然后遍历原始数组，将原始数组中的每个元素与新数组中的每个元素进行比对，如果不重复则添加到新数组中，最后返回新数组；因为它的时间复杂度是O(n^2)，如果数组长度很大，那么将会非常耗费内存</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> res = [arr[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> flag = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; res.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] === res[j]) &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;<span class="comment">//利用一个flag来判断是否已存在，关键</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            res.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>方法四：indexOf方法</p>
<p>数组的indexOf()方法可返回某个指定的元素在数组中首次出现的位置。该方法首先定义一个空数组res，然后调用indexOf方法对原来的数组进行遍历判断，如果元素不在res中，则将其push进res中，最后将res返回即可获得去重的数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> res = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.indexOf(arr[i]) === <span class="number">-1</span>) &#123;</span><br><span class="line">            res.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<p>来点随堂练习👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">delete</span> x;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;)(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>结果为1。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 形参实际上就是隐式地执行了 var x;</span></span><br><span class="line">  <span class="comment">// 同时注意，var出来的变量，如果不是作为属性而存在的话，是无法被delete掉的</span></span><br><span class="line">  <span class="keyword">delete</span> x;<span class="comment">//无效</span></span><br><span class="line">  <span class="keyword">return</span> x;<span class="comment">//该是啥就是啥</span></span><br><span class="line">&#125;)(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<hr>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> h = <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">23</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> a());<span class="comment">//Uncaught ReferenceError: a is not defined</span></span><br></pre></td></tr></table></figure>
<hr>




          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/28/预编译-作用域-闭包-立即执行函数.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/28/预编译-作用域-闭包-立即执行函数.html" itemprop="url">复习预编译-作用域-闭包-立即执行函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-28T00:00:00+08:00">
                2019-10-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h2><p>👉<a href="http://doc.liangxinghua.com/javascript/3.1.html" target="_blank" rel="noopener">点击</a></p>
<p>【补充】：</p>
<ul>
<li><p>注意区分什么是函数声明、什么是函数表示，不要混淆。</p>
</li>
<li><p>命定表达式</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570686806366.png" alt="1570686806366"></p>
<p>函数按照上面的方式定义后，只有test才是函数，test1不是一个函数，但是test1是test的name，可以通过test.name得到。</p>
</li>
</ul>
<h2 id="参数、返回值"><a href="#参数、返回值" class="headerlink" title="参数、返回值"></a>参数、返回值</h2><p>👉<a href="http://doc.liangxinghua.com/javascript/3.2.html" target="_blank" rel="noopener">点击</a></p>
<p><br><br></p>
<h2 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h2><p>JavaScript执行的三部曲：</p>
<p>​    1、语法分析：先通篇扫描一下看有没有语法错误，但是不执行。</p>
<p>​    2、预编译</p>
<p>​    3、解释执行</p>
<hr style="background-color:lightblue">

<p><strong>【函数声明整体提升，变量的声明提升，变量的赋值不提升】</strong></p>
<p>我们知道JavaScript是解释一行执行一行的，看下面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">666</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它是可以成功执行打印出666的。因为<strong>函数声明整体提升</strong>了，它会把函数的声明提升到逻辑的最前面。</p>
<p>再看下面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);</span><br></pre></td></tr></table></figure>
<p>报错，a未定义。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">123</span>;</span><br></pre></td></tr></table></figure>
<p>可执行，但是打印结果为<strong>undefined</strong>。这说明了 a 是<strong>已经声明但是尚未赋值</strong>。这一现象是<strong>变量的声明提升</strong>。</p>
<p>但是，这两个口诀治标不治本，必须把预编译搞明白。</p>
<hr style="background-color:lightblue">

<p><strong>imply global  暗示全局变量</strong>：</p>
<p>任何变量，如果变量未经声明就赋值，此变量就为全局对象window所有。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">	a = <span class="number">10</span>; <span class="comment">//未经声明就赋值，相当于window.a = 10;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>再来一个栗子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = b = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure>
<p>这个执行结果是报错的。</p>
<p><code>var a = b= 10</code>是从右往左赋值的，先将10赋值给b，但是b没有声明所以它是一个全局变量，之后再把b赋值给a，a有声明变量，它是函数test里面的一个局部变量。外界是无法访问a的，所以报错。但是如果打印b是可以正确输出10的。</p>
<hr style="background-color:lightblue">

<p><strong>一切声明的全局变量，都归window所有，都是window的属性</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	var a = 10; //相当于window.a = 10;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<hr style="background-color:lightblue">

<h3 id="函数预编译"><a href="#函数预编译" class="headerlink" title="函数预编译"></a>函数预编译</h3><p>函数预编译发生在函数执行的前一刻。过程如下：</p>
<ul>
<li>创建AO对象（Activation Object 执行期上下文，它的作用就是我们理解的作用域）</li>
<li>找形参和变量声明，将变量和形参名作为AO对象的属性名，值为undefined</li>
<li>将实参值和形参统一</li>
<li>找函数声明，将函数名也作为AO对象的属性名挂起来，将该声明的函数体作为值。</li>
</ul>
<p>举个栗子👇</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570706022488.png" alt="1570706022488"></p>
<p>这段代码执行结果为？</p>
<p>栗子1👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(a);</span><br><span class="line">      c = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">var</span> c;</span><br><span class="line">      a = <span class="number">3</span>;</span><br><span class="line">      b = <span class="number">2</span>;</span><br><span class="line">      <span class="built_in">console</span>.log(b);</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(b);</span><br><span class="line">    &#125;</span><br><span class="line">    test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p>栗子2👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">234</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">  a = <span class="number">123</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  b = <span class="number">234</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<hr style="background-color:lightblue">

<h3 id="全局预编译"><a href="#全局预编译" class="headerlink" title="全局预编译"></a>全局预编译</h3><p>和函数的预编译类似，同时它产生的叫做GO，GO就是window</p>
<ul>
<li>创建GO对象（global object 全局上下文，它的作用就是我们理解的全局作用域）</li>
<li>找形参和变量声明，将形参名、变量名作为GO对象的属性名，值为undefined</li>
<li>找函数声明，将函数名也作为GO对象的属性名挂起来，将该声明的函数体作为值。</li>
</ul>
<p>举个栗子👇</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570758880702.png" alt="1570758880702"></p>
<p>上面的栗子改动一下👇</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570759070170.png" alt="1570759070170"></p>
<p>来练练👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(test);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(test);</span><br><span class="line">  <span class="keyword">var</span> test = <span class="number">234</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(test);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> test = <span class="number">123</span>;</span><br><span class="line"><span class="built_in">console</span>.log(test);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(bar());</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      foo = <span class="number">10</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> foo = <span class="number">11</span>;</span><br><span class="line">      <span class="keyword">return</span> foo;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> foo;</span><br><span class="line">  foo = <span class="number">10</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="number">11</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(bar());</span><br></pre></td></tr></table></figure>
<p><hr style="background-color:lightblue"></p>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>每个JavaScript函数都是一个对象，对象中有些属性我们可以访问。也有些是不可以访问的，这种属性仅供JavaScript引擎存取，[[scope]]就是其中之一。</p>
<p>[[scope]]指的就是作用域，其中存储了运行期上下文的集合。</p>
<p>[[scope]]中所存储的执行期上下文对象的集合，这种集合呈链式链接，称作是<strong>作用域链</strong></p>
<hr style="background-color:lightblue">

<p><strong>执行期上下文</strong>：当函数执行时，会创建一个称为执行期上下文的内部对象。一个执行期上下文定义了一个函数执行时的环境，函数每次执行时对应的执行上下文都是独一无二的，所以多次调用同一个函数会导致创建多个执行上下文，当函数执行完毕，它所产生的执行上下文就销毁。爽完了就抛弃，渣男！</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">test()  <span class="comment">//第一个执行test函数，创建了一个它的执行上下文AO</span></span><br><span class="line">		<span class="comment">//执行完毕后，AO就被销毁了</span></span><br><span class="line">test()  <span class="comment">//再一次执行test函数，又需要创建一个执行上下文AO</span></span><br><span class="line">		<span class="comment">//爽完之后再次抛弃(╬▔皿▔)凸</span></span><br></pre></td></tr></table></figure>
<p><hr style="background-color:lightblue"><br>举个栗子👇</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570772661596.png" alt="1570772661596"></p>
<p>这段代码首先是函数a的声明，a函数被定义的时候就产生了如下环节：</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570772746072.png" alt="1570772746072"></p>
<p>a的[[scope]]里面存的是scope chain即作用域链，这时候作用域链里只有一个全局执行上下文GO，紧接着执行代码<code>var glob = 100</code>更新GO。紧接着执行函数a()。</p>
<p>a函数执行的时候就产生了它的执行期上下文AO，并把AO放到作用域链的最顶端，现前的GO就往后稍稍。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773023375.png" alt="1570773023375"></p>
<p>一旦我们再a里面查找一个变量的话，它会从a的作用域链的顶端——AO<strong>依次向下</strong>查找。</p>
<p>紧接着，由于a的执行产生了一个过程——b函数的定义，b作为函数也有自己的[[scope]]，但是b刚出生时它的环境就是a给它的，所以b可以捡现成的[[scope]]。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773293755.png" alt="1570773293755"></p>
<p>即b刚刚被定义的时候，它保存的就是a的劳动成果。</p>
<p>重点在于b函数被执行的时候，它也产生了它的执行上下文AO，将其放在作用域链的最顶端，之前a的AO和GO就又往后稍稍了。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773491976.png" alt="1570773491976"></p>
<p>这时如果在b里面找一个变量的话，也是从作用域链的最顶端自顶向下查找。</p>
<p>b()执行完成之后，b自己的AO就被销毁了，b.[[[scope]]回到了b一开始被定义的时候；</p>
<p>接着b()执行完说明a()也执行完成了，a自己的AO也被销毁了，a.[[scope]]回到了a一开始定义的时候。</p>
<p><hr style="background-color:lightblue"><br>再举个栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    c();</span><br><span class="line">  &#125;</span><br><span class="line">  b();</span><br><span class="line">&#125;</span><br><span class="line">a()</span><br></pre></td></tr></table></figure>
<p>执行a()，得到作用域链如下：</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570775695313.png" alt="1570775695313"></p>
<p>在任何一个函数里面想要访问一个变量，找它的作用域链就完事了。想要访问变量一定是看在这个函数执行时产生的作用域链，而且是自顶向下访问。</p>
<p>假如我们要在b函数里面访问c函数里定义的cc变量，那么这时候我们是站在【b executing  b.[[scoep]]】这个作用域链上的，而这个作用域链里面根本没有cAO，也就访问不到c函数里面定义的cc变量了。这就是为什么函数外部无法访问函数内部的变量的原因。</p>
<p>ps：上面这段代码如果a函数没有执行就没有【a executing 。。。】及其之后的作用域链。</p>
<p><br><br></p>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>一个栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bbb = <span class="number">234</span>;</span><br><span class="line">    <span class="built_in">document</span>.write(aaa);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> aaa = <span class="number">123</span>;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> glob = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> demo = a();</span><br><span class="line">demo();</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570777469422.png" alt="1570777469422"></p>
<p>a执行完毕后销毁了aAO，讲道理，里面的aaa也应该销毁了，但是a函数把b返回了出来并且赋给了demo，导致demo保留了aAO，从而可以访问到aaa。最终结果是打印出123。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570777779515.png" alt="1570777779515"></p>
<p>这就是闭包。</p>
<p><strong>但凡函数内部的函数，被保存到了外面，一定生成闭包。</strong></p>
<hr style="background-color:lightblue">

<p>再来个详细一点的图文：</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570780727395.png" alt="1570780727395"></p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570784350992.png" alt="1570784350992"></p>
<hr style="background-color:lightblue">

<p>当内部函数被保存到外部时，将会生成闭包。</p>
<h2 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h2><ul>
<li><p>实现公有变量</p>
<ul>
<li><p>栗子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">demo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     count++;</span><br><span class="line">     <span class="built_in">console</span>.log(count);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> demo</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//这样就把count这个变量公有化了</span></span><br><span class="line"> <span class="keyword">var</span> counter = add();</span><br><span class="line">    </span><br><span class="line"> setInterval(counter, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>可以做缓存（存储结构）</p>
</li>
<li><p>可以实现封装，属性私有化</p>
</li>
<li><p>模块化开发，防止污染全局变量</p>
</li>
</ul>
<p>【闭包的缺点】闭包会导致原有作用域链不释放，占用内存，造成内存泄漏。</p>
<p><br><br></p>
<h2 id="立即执行函数"><a href="#立即执行函数" class="headerlink" title="立即执行函数"></a>立即执行函数</h2><p>执行完立即销毁</p>
<p>两种格式：</p>
<ul>
<li>(function () { })()</li>
<li>(function () { }())</li>
</ul>
<p><br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()<span class="comment">//这样是可以成功执行的</span></span><br></pre></td></tr></table></figure>
<p>而且打印test结果就是test函数的函数体。那么我这样写行不行呢？👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<p>⚠很遗憾，不行！！！</p>
<p>这里记住：【只有表达式才能被执行符号()执行】</p>
<p>所以上面栗子中<code>function test(){}</code>它是函数声明，不是表达式，不可以被执行；</p>
<p>而<code>test()</code>中<code>test</code>就算单独杵着它也是一个表达式，不是说非要<code>a+b</code>之类的才叫表达式，单独的<code>123;</code>、<code>test</code>也是表达式了。</p>
<p>那么！函数表达式能不能被执行呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<p>都叫表达式了它就一定能被执行。</p>
<p>【奇技淫巧】</p>
<p>记住表达式能被立即执行则表达式的名字不存在，举个栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在控制台操作如下：</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570789411336.png" alt="1570789411336"></p>
<p>这个test的名字还代表着这个函数。    </p>
<p>但是，我们在函数表达式后边加一个括号，这个表达式就可以被立即执行了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<p>控制台中打印test为undefined，它就不再代表函数了，<code>function(){console.log(666)}</code>被永久的放弃了，这也符合立即执行函数的特点，用完就销毁。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570789509076.png" alt="1570789509076"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ function test() &#123;</span><br><span class="line">  console.log(666);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<p>函数声明后面加上括号是不可以被执行的，但是在函数声明前面加上一个加号，就会使得<code>function test(){}</code>有一个转化为number类型的趋势，整个<code>+ function(){}</code>就变成了一个表达式,，从而可以被括号执行。同样的减号也可以办到。但是乘号除号不可以。</p>
<p>以下的运算符都可以办到：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> || <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">    <span class="number">1</span> &amp;&amp; <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"> !<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<p>被执行了之后，test就不再代表<code>function (){}</code>了，变成了undefined。</p>
<p>以上的核心步骤就是【将函数声明变成表达式，就可以被立即执行了】</p>
<p><strong>那么括号()也是运算符，将函数声明用括号包起来，就能将函数声明变成表达式了！因此可以被立即执行。这就是立即执行函数的原理。</strong></p>
<p>好，来个迷惑又恶心的 栗子👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a + b + c + d);</span><br><span class="line">&#125; (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>这个居然不报错！因为系统将其理解成了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(a + b + c + d);</span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>虽然不报错，但也没执行test函数。</p>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570795567350.png" alt="1570795567350"></p>
<p>再来一个👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = (</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">)();</span><br><span class="line"><span class="built_in">console</span>.log(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> f);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570807949996.png" alt="1570807949996"></p>
<p>再来一个难的栗子👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; &#125;) &#123;</span><br><span class="line">  x += <span class="keyword">typeof</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(x);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570810489773.png" alt="1570810489773"></p>
<hr>

<p>【一颗经典的栗子】👇：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    arr[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>我们想要的结果是输出从0到9，但是结果是输出了十个10。为啥呢？</p>
<p>在for循环的过程中，把函数体<code>function(){console.log(i)}</code>赋给了arr[0]、arr[1]、arr[2]。。。。。arr[9]，注意不是把<code>function(){console.log(0)}</code>赋给了arr[0]、把<code>function(){console.log(1)}</code>赋给arr[1]。。。把<code>function(){console.log(9)}</code>赋给arr[9]。这点要搞清楚。所以循环结束，是把十个相同的函数体赋给了数组arr，而在执行arr里的每一个元素即每一个函数体的时候，才会给函数体里的 i 进行赋值，而赋值的时候可以看到 i 的值为10！所以最终打印除了十个10。</p>
<p>{建议手写GO、AO作用域链，可以更理解清晰）</p>
<p>解决方案：</p>
<p>方法一：利用立即执行函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">j</span>) </span>&#123;</span><br><span class="line">      arr[j] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>方案二：另一种立即执行函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ele);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    arr[i] = foo(i)；<span class="comment">//参数传入时foo函数就执行了</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>以上栗子的实际应用如下👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给每个li添加点击事件，点击时打印该li的顺序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> liCollection = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; liCollection.length; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">j</span>) </span>&#123;</span><br><span class="line">      liCollection[j].onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="with"><a href="#with" class="headerlink" title="with"></a>with</h2><p>with 可以改变作用域链</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'obj-name'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"window"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'scope'</span>;</span><br><span class="line">  <span class="keyword">with</span> (obj) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<p>with(obj){…}括号里填入对象obj，会把这个对象obj当作with圈定的代码体的作用域链的最顶端，即把obj当作最顶端的AO（执行上下文），所以打印出来的name就是obj里的name。</p>
<p>💡应用场景</p>
<p>之前说过命名空间</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> org = &#123;</span><br><span class="line">  dp1: &#123;</span><br><span class="line">    jc: &#123;</span><br><span class="line">      name: <span class="string">'jicheng'</span>,</span><br><span class="line">      age: <span class="number">22</span></span><br><span class="line">    &#125;,</span><br><span class="line">    deng: &#123;</span><br><span class="line">      name: <span class="string">"laodeng"</span>,</span><br><span class="line">      age: <span class="number">30</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  dp2: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当dp1部门的jc要开发的时候,通过如下方式获取并编程</span></span><br><span class="line"><span class="comment">// org.dp1.jc.age</span></span><br><span class="line"><span class="comment">// org.dp1.jc.name</span></span><br><span class="line"><span class="comment">// org.dp1.jc.xxx....</span></span><br><span class="line"><span class="comment">// 这样太麻烦了，可以先var jc = org.dp1.jc  从而简化代码</span></span><br><span class="line"><span class="comment">// 实际上开发时使用with的，这样最简便</span></span><br><span class="line"><span class="keyword">with</span> (org.dp1.jc) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">  <span class="built_in">console</span>.log(age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>⚠使用with会降低效率，所以<br>ES5严格模式禁止使用它。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/17/Vue页面间通信传值的方法.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/17/Vue页面间通信传值的方法.html" itemprop="url">Vue页面间通信传值的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-17T00:00:00+08:00">
                2019-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="页面跳转与传值"><a href="#页面跳转与传值" class="headerlink" title="页面跳转与传值"></a>页面跳转与传值</h2><h3 id="一、使用router-link"><a href="#一、使用router-link" class="headerlink" title="一、使用router-link"></a>一、使用router-link</h3><p>routes路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/'</span>,</span><br><span class="line">        name: <span class="string">'Index'</span>,</span><br><span class="line">        component: Index</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/deitail'</span>,</span><br><span class="line">        name: <span class="string">'deitail'</span>,</span><br><span class="line">        component: deitail</span><br><span class="line">      &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>使用<code>&lt;router-link&gt;</code>进行跳转和传值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to=&quot;&#123;name:&apos;deitail&apos;,params:&#123;freezeMon:&apos;2017-10&apos;,owerName:&apos;西安&apos;&#125;&#125;&quot; tag=&quot;div&quot; &gt;</span><br><span class="line">&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
<p>取值时：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;$route.params.freezeMon&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>小结：router-link跳转传值要注意的地方</p>
<ul>
<li>to前面要加 <code>:</code></li>
<li>to后面{中的name值要与路由中的name值一致</li>
</ul>
<h3 id="二、使用-router-push"><a href="#二、使用-router-push" class="headerlink" title="二、使用$router.push()"></a>二、使用$router.push()</h3><h4 id="query写法"><a href="#query写法" class="headerlink" title="query写法"></a>query写法</h4><p><strong>传值的路由</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login?uname="</span> + <span class="keyword">this</span>.userName</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>传值路由第二种写法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login"</span>,</span><br><span class="line">  query: &#123;</span><br><span class="line">    uname: <span class="keyword">this</span>.userName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>接收值的路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"接收过来的值为："</span> + <span class="keyword">this</span>.$route.query.uname);        <span class="comment">//这里是$route 没有r----</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="params写法"><a href="#params写法" class="headerlink" title="params写法"></a>params写法</h4><p><strong>传值路由第一种写法（还是会将参数显示在地址栏中）</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login/"</span> + <span class="keyword">this</span>.userName</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>传值路由的第二种写法（不会将参数显示在地址栏中）</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  name: <span class="string">"login"</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    uname: <span class="keyword">this</span>.userName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>接收值的路由</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"接收过来的值为："</span> + <span class="keyword">this</span>.$route.params.uname);</span><br></pre></td></tr></table></figure>
<p>注意：在使用params传递参数的时候，我们需要在router的对象里面，找到当前的这个路由，然后去更改它的 path</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   path: <span class="string">"/login/:uname"</span>, <span class="comment">//代表当前url跳转的路径</span></span><br><span class="line">   component: login, <span class="comment">//代表在当前这个路径下面，我们如何显示组件（显示那一个组件）</span></span><br><span class="line">   name: <span class="string">"login"</span> <span class="comment">//给当前路由取一个别名</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>上面的path后面是 /login/:uname ,这一个是我们的一个路径变量，前面的login代表路由，而后面<code>:uname</code>代表的是变量</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/15/防抖节流.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/15/防抖节流.html" itemprop="url">防抖节流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-15T00:00:00+08:00">
                2019-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景问题"><a href="#背景问题" class="headerlink" title="背景问题"></a>背景问题</h2><p>在前端开发中有一部分的用户行为会频繁的触发事件，从而频繁地执行函数，而对于DOM操作、资源加载等耗费性能的处理，很可能导致界面卡顿，甚至浏览器崩溃（本质是因为js是单线程的）。</p>
<p>函数节流（throttle）和函数防抖（debounce）可以解决问题。</p>
<h2 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h2><p>函数防抖就是在函数需要频繁触发情况时，只有等足够空闲的事件，才执行，为了避免又有事件触发。</p>
<ul>
<li>常见应用场景：搜索框实时搜索请求数据、拖拽</li>
</ul>
<ul>
<li>代码实现：</li>
</ul>
<p>关键点：设置定时器、this的指向、arguments的指向 </p>
<p>模拟搜索框实时请求数据👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oInp = <span class="built_in">document</span>.getElementById(<span class="string">'inp'</span>);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">oInp.oninput = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// console.log(arguments);</span></span><br><span class="line">  <span class="keyword">var</span> _self = <span class="keyword">this</span>;<span class="comment">//想要的是输入框input的数据，若无此步，setTimeout的this指向window</span></span><br><span class="line">  <span class="keyword">var</span> _arg = <span class="built_in">arguments</span>;</span><br><span class="line">  clearTimeout(timer);</span><br><span class="line">  timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    ajax.apply(_self, _arg)<span class="comment">//改变this指向，让输入框元素实际调用这个函数</span></span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e, <span class="keyword">this</span>.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码只能应对发送ajax这种业务，下面进行一下防抖的封装</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oInp = <span class="built_in">document</span>.getElementById(<span class="string">'inp'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e, <span class="keyword">this</span>.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">handler, delay</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handler  要进行防抖处理的功能性函数</span></span><br><span class="line">  <span class="comment">// delay    延迟时间</span></span><br><span class="line">  <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> _arg = <span class="built_in">arguments</span>;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      handler.apply(_self, _arg)</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">oInp.oninput = debounce(ajax, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>
<h2 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h2><p>函数节流就是预定一个函数只有在大于或等于执行周期时才执行，周期内调用不执行。</p>
<ul>
<li>常见应用场景<ul>
<li>窗口调整</li>
<li>页面滚动数据加载</li>
<li>防止恶意脚本抢购疯狂点击</li>
</ul>
</li>
</ul>
<ul>
<li><p>代码实现</p>
<p>模拟抢红包的功能👇</p>
<p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1571146823113.png" alt="1571146823113"></p>
<p>这种代码如果被人注入恶意脚本，使得按钮点击事件疯狂触发，服务器和客户端都受不了。为了避免这种情况，使用节流操作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">我抢到<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"show"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>个红包！</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="keyword">var</span> oSpan = <span class="built_in">document</span>.getElementById(<span class="string">'show'</span>);</span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// oBtn.onclick = function () &#123;</span></span><br><span class="line"><span class="comment">//   oSpan.innerText = parseInt(oSpan.innerText) + 1;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">oBtn.onclick = throttle(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  oSpan.innerText = <span class="built_in">parseInt</span>(oSpan.innerText) + <span class="number">1</span>;</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">handler, wait</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lastTime = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="keyword">if</span> (nowTime - lastTime &gt; wait) &#123;</span><br><span class="line">      handler();</span><br><span class="line">      lastTime = nowTime;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再改进一下👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oSpan = <span class="built_in">document</span>.getElementById(<span class="string">'show'</span>);</span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">  </span><br><span class="line">oBtn.onclick = throttle(crazyClick, <span class="number">1000</span>)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">handler, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> lastTime = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">        <span class="keyword">if</span> (nowTime - lastTime &gt; wait) &#123;</span><br><span class="line">            handler.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">            lastTime = nowTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">crazyClick</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>, e);</span><br><span class="line">    oSpan.innerText = <span class="built_in">parseInt</span>(oSpan.innerText) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<p>假设无限次触发：防抖函数永远不会真正执行；节流函数则会按照间隔时间执行。</p>
<p>防抖动和节流本质是不一样的。防抖动是将多次执行变为最后一次执行，节流是将多次执行变成每隔一段时间执行。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/08/Redis.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/08/Redis.html" itemprop="url">Redis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-08T00:00:00+08:00">
                2019-10-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="缓存背景"><a href="#缓存背景" class="headerlink" title="缓存背景"></a>缓存背景</h2><p>由于数据库是建立在硬盘上的，当有大量数据读写数据库时，而硬盘的读写速度慢，导致数据库性能有瓶颈，数据吞吐不够。</p>
<p>因此在客户端和数据库之前间，加一个<strong>缓存</strong>，而这个缓存是用内存做的，<strong>内存的读写速度非常快</strong>。 当要对数据库进行读写时，先访问中间层的缓存，读数据时先看缓存中有无想要的数据，若有直接从缓存拿，若无则再去访问数据库；写数据时，先写进缓存，之后缓存再慢慢同步到数据库。这样就帮数据库有效地拦截了一些频繁的读写操作。</p>
<p><img src="https://pic4.zhimg.com/v2-ae215207d175303dd4e37b37b61a7d33_r.jpg" alt=""></p>
<p>【什么样的数据存入缓存】缓存中存的应是读写数据库非常频繁的数据。</p>
<p>【防止缓存穿透】缓存穿透是指查询一个一定不存在的数据，由于缓存是不命中时被动写的，并且出于容错考虑，如果从存储层查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到存储层去查询，失去了缓存的意义。在流量大时，可能DB就挂掉了，要是有人利用不存在的key频繁攻击我们的应用，这就是漏洞。这需要一些算法去识别，比如布隆算法。参考文章👉<a href="https://blog.csdn.net/zeb_perfect/article/details/54135506" target="_blank" rel="noopener">点击</a></p>
<p><br></p>
<p>缓存这一层就用<strong>Redis</strong>来做。Redis既使用内存，也使用硬盘。作为读写操作的时候是用内存的，但是内存存数据是暂时的，机器一关内存里的东西就没了，所以需要用到硬盘来做缓存备份。内存与硬盘之间是同步数据和恢复数据的关系。</p>
<p>Redis是用C语言写的，Redis支持多种数据结构，key-value、key-map、key-set、key-list等等。比较常用的就是key-value，key一般是字符串，value可以是数字也可以是字符串。但是C语言中是没有字符串的。而Redis中的字符串长度是可变的，是用了SDS结构（Simple Dynamic String）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录 buf 数组中已使用字节的数量</span></span><br><span class="line">    <span class="comment">// 等于 SDS 所保存字符串的长度</span></span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录 buf 数组中未使用字节的数量</span></span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">free</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 字节数组，用于保存字符串</span></span><br><span class="line">    <span class="keyword">char</span> buf[];</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>当字符串变长时，先看sds结构内free还有没有足够的空间，没有的话就要重新创建一个更大的字节数组用以存储变长后的字符串。</p>
<p>关于更多Redis源码的知识这里就不说了，因为我只懂一点皮毛。</p>
<p><br></p>
<h2 id="Windows使用Redis"><a href="#Windows使用Redis" class="headerlink" title="Windows使用Redis"></a>Windows使用Redis</h2><p>Redis是微软开源的一个存储数据库。可以在GitHub上下载👉<a href="https://github.com/microsoftarchive/redis/releases" target="_blank" rel="noopener">https://github.com/microsoftarchive/redis/releases</a></p>
<p>注意window系统中只有64位的系统才能使用Redis。</p>
<p><img src="https://pic2.zhimg.com/v2-754e178d110a14222ca88e9d52ee724d_r.jpg" alt=""></p>
<p>下载后点击，不需要配置什么，按提示安装就行了。安装后要配置一些配置文件。</p>
<p><br></p>
<p><strong>设置链接密码，修改redis.windows-service.conf</strong></p>
<p>​    <img src="https://pic4.zhimg.com/v2-3d74b5d6edf13cb03fca1b642b1abc6b_r.jpg" alt=""></p>
<p><br></p>
<p><strong>查看是否允许本地访问</strong>，有的版本是允许的，如下所示</p>
<p><img src="https://pic3.zhimg.com/v2-f62414b17a45477d65578f64858c555e_r.jpg" alt=""></p>
<p><br></p>
<p>配置修改后需要重启Redis，打开系统的”服务“，找到Redis重启即可。</p>
<p><br></p>
<p>双击redis-cli.exe启动。</p>
<p>输入<code>auth 123456</code>连接Redis。通过<code>set</code>键值对来写入数据，通过<code>get</code>键来获取数据。</p>
<p><img src="https://pic4.zhimg.com/80/v2-c2683c7ddec97d9396f726cfbe89c9bb_hd.jpg" alt=""></p>
<h2 id="CentOS使用Redis"><a href="#CentOS使用Redis" class="headerlink" title="CentOS使用Redis"></a>CentOS使用Redis</h2><p>使用安装包下载👇</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-4.0.2.tar.gz</span><br></pre></td></tr></table></figure>
<p>解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xzf redis-4.0.2.tar.gz</span><br></pre></td></tr></table></figure>
<p>下载gcc依赖环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br></pre></td></tr></table></figure>
<p>执行下面的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make MOLLOC=libc</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>之后再<code>/usr/local/bin</code>目录下就多了Redis的可执行文件</p>
<p><img src="https://pic3.zhimg.com/v2-8dda927023de977c96fdf8b25f4b581e_r.jpg" alt=""></p>
<p>执行命令👇</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sever &amp;</span><br></pre></td></tr></table></figure>
<p>这样它就可以在后台运行了。</p>
<p>执行<code>ps aux grep|&quot;redis&quot;</code>查看到redis的进程正在执行。</p>
<p>如果要关闭Redis，就杀了它的进程。</p>
<p><img src="https://pic1.zhimg.com/v2-dff48949afd760407a8abce57ff851ec_r.jpg" alt=""></p>
<p><br></p>
<h2 id="node操作Redis"><a href="#node操作Redis" class="headerlink" title="node操作Redis"></a>node操作Redis</h2><p>需要<code>npm install redis --save</code>安装redis模块。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> redis = <span class="built_in">require</span>(<span class="string">'redis'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> port = <span class="number">6379</span>;</span><br><span class="line"><span class="keyword">var</span> host = <span class="string">"127.0.0.1"</span>;</span><br><span class="line"><span class="keyword">var</span> password = <span class="string">"123456"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> client = redis.createClient(port, host);</span><br><span class="line">client.auth(password, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"OK，redis连接成功"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getKey</span>(<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    client.on(<span class="string">"connect"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.get(key, callback);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setKey</span>(<span class="params">key, value, callback</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.set(key, value, callback);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">error, reply</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reply);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">setKey(<span class="string">'iii'</span>, <span class="string">'III'</span>, callback);</span><br><span class="line">getKey(<span class="string">'iii'</span>, callback);</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>之前说过redis除了key-value的数据结构，还可以存哈希结构的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sethash</span>(<span class="params">hash, key, value, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hset(hash, key, value, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gethash</span>(<span class="params">hash, key, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hget(hash, key, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getallhash</span>(<span class="params">hash, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hgetall(hash, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hmset</span>(<span class="params">hash, params, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hmset(hash, ...params, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">error, reply</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reply);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sethash(<span class="string">'map1'</span>, <span class="string">'key1'</span>, <span class="string">'value1'</span>, callback)</span><br><span class="line">sethash(<span class="string">'map1'</span>, <span class="string">'key2'</span>, <span class="string">'value2'</span>, callback)</span><br><span class="line">hmset(<span class="string">'set1'</span>, [<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">12</span>], callback)</span><br><span class="line">gethash(<span class="string">'map1'</span>, <span class="string">'key1'</span>, callback)</span><br><span class="line">getallhash(<span class="string">'map1'</span>, callback)</span><br><span class="line">getallhash(<span class="string">'set1'</span>, callback)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/05/mongoDB.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/05/mongoDB.html" itemprop="url">mongoDB</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-05T00:00:00+08:00">
                2019-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Windows安装"><a href="#Windows安装" class="headerlink" title="Windows安装"></a>Windows安装</h2><p>下载地址：<a href="https://www.mongodb.com/download-center/community" target="_blank" rel="noopener">https://www.mongodb.com/download-center/community</a></p>
<p>运行mongo.exe</p>
<p>输入<code>show dbs</code>显示数据库。</p>
<p><img src="https://pic2.zhimg.com/80/v2-f16be839b9b3f541f4de299d92ae0b75_hd.jpg" alt=""></p>
<p><br></p>
<h2 id="CentOS安装"><a href="#CentOS安装" class="headerlink" title="CentOS安装"></a>CentOS安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.4.9.tgz</span><br></pre></td></tr></table></figure>
<p>执行该命令下载安装报包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf mongodb-linux-x86_64-2.4.9.tgz</span><br></pre></td></tr></table></figure>
<p>解压之后移动到/usr/local中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ./mongodb-linux-x86_64-2.4.9.tgz /usr/local/mongodb</span><br></pre></td></tr></table></figure>
<p>数据库存放到/home目录下，在/home目录下新建两个文件夹并创建mongodb.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir mongodb  /home/mongodb 即为数据库路径</span><br><span class="line">mkdir mongodblog  /home/mongodblog  日志路径</span><br><span class="line">cd /home/mongodblog</span><br><span class="line">touch mongodb.log</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mongodb/bin</span><br><span class="line">ll</span><br><span class="line">可以看到有一个可执行文件mongod</span><br></pre></td></tr></table></figure>
<p>回到mongodb的根路径下执行👇</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/mongod --dbpath /home/mongodb/ --logpath /home/mongolog/mongodb.log --fork --port 27017</span><br></pre></td></tr></table></figure>
<p><code>--fork</code>使得mongodb在后台执行。</p>
<p>查看是否成功启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux |grep &quot;mongo&quot;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="mongodb基本指令"><a href="#mongodb基本指令" class="headerlink" title="mongodb基本指令"></a>mongodb基本指令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">查看数据库：</span><br><span class="line">show dbs</span><br><span class="line"></span><br><span class="line">使用数据库, （use 数据库名）如果这给数据库不存在，则创建之：</span><br><span class="line">use &lt;database&gt;</span><br><span class="line"></span><br><span class="line">查看当前数据库名：</span><br><span class="line">db.getName()</span><br><span class="line"></span><br><span class="line">mongodb没有mysql表的概念，但是有集合collection</span><br><span class="line">查看collection：</span><br><span class="line">show collections</span><br><span class="line"></span><br><span class="line">创建collection：</span><br><span class="line">db.createCollection(&apos;集合名称&apos;)</span><br><span class="line"></span><br><span class="line">集合中增加数据：</span><br><span class="line">db.collection1.save(&#123;name:&apos;tony&apos;,age:18&#125;);</span><br><span class="line"></span><br><span class="line">查询集合中所有数据：</span><br><span class="line">db.collection1.find()</span><br><span class="line"></span><br><span class="line">查询集合中有几条数据：</span><br><span class="line">db.collection1.find().count()</span><br><span class="line"></span><br><span class="line">条件查询:</span><br><span class="line">db.collection1.find(&#123;age:18&#125;)//age为18的数据</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gt:18&#125;&#125;)//age大于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$lt:18&#125;&#125;)//age小于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gte:18&#125;&#125;)//age大于等于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$lte:18&#125;&#125;)//age小于等于18</span><br><span class="line"></span><br><span class="line">名字去重</span><br><span class="line">db.collection1.distinct(&quot;name&quot;)</span><br><span class="line"> </span><br><span class="line">多重条件查询</span><br><span class="line">and：</span><br><span class="line">db.collection1.find(&#123;$and:[&#123;age:18&#125;,&#123;name:&apos;tony&apos;&#125;]&#125;)  //要特别注意这种写法</span><br><span class="line">or:   </span><br><span class="line">db.collection1.find(&#123;$or:[&#123;age:18&#125;,&#123;name:&apos;tony&apos;&#125;]&#125;)</span><br><span class="line"></span><br><span class="line">查询age大于12小于19：</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gt:12, $lt:19&#125;&#125;)</span><br><span class="line"></span><br><span class="line">查询前两条数据：</span><br><span class="line">db.collection1.find().limit(2)</span><br><span class="line"></span><br><span class="line">跳过前两条然后只查看两条：</span><br><span class="line">db.collection1.find().skip(2).limit(2)</span><br><span class="line"></span><br><span class="line">删除age为12的数据：</span><br><span class="line">db.collection1.remove(&#123;age:12&#125;)</span><br><span class="line"></span><br><span class="line">修改：</span><br><span class="line">db.collection1.update(&#123;name:&apos;tony&apos;&#125;,&#123;$set:&#123;age:80&#125;&#125;, false ,true)</span><br></pre></td></tr></table></figure>
<p>更多操作Google一下。</p>
<p><br></p>
<h2 id="node操作mongodb"><a href="#node操作mongodb" class="headerlink" title="node操作mongodb"></a>node操作mongodb</h2><p>先安装mongodb依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongodb --save</span><br></pre></td></tr></table></figure>
<p>先保证开启了mongodb，最基本的连接👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongo = <span class="built_in">require</span>(<span class="string">'mongodb'</span>).MongoClient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">"mongodb://127.0.0.1:27017/test"</span>;  <span class="comment">//本地ip地址、端口号和数据库名称</span></span><br><span class="line"></span><br><span class="line">mongo.connect(url, <span class="function"><span class="keyword">function</span> (<span class="params">error, db</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(db);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">    db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>进行【增删改查】代码操作👇</p>
<p>未完待续。。。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunteng.github.io/[object Object]2019/10/05/聊天机器人.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dunteng Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunteng's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/[object Object]2019/10/05/聊天机器人.html" itemprop="url">聊天机器人</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-05T00:00:00+08:00">
                2019-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>这个Demo用node.js实现代理服务器，核心的api是<a href="http://www.turingapi.com/" target="_blank" rel="noopener">图灵机器人</a>，浏览器使用这个api存在跨域问题，所以用<strong>node.js代理服务器解决跨域问题</strong>。</p>
<p><br></p>
<h2 id="关于后端解决跨域"><a href="#关于后端解决跨域" class="headerlink" title="关于后端解决跨域"></a>关于后端解决跨域</h2><p><img src="https://pic3.zhimg.com/v2-1c347617d163242e7def6c157e82fc76_r.jpg" alt=""></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://github.com/Dunteng/node.js/tree/v1/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA" target="_blank" rel="noopener">https://github.com/Dunteng/node.js/tree/v1/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA</a></p>
<h2 id="未完待续。。。"><a href="#未完待续。。。" class="headerlink" title="未完待续。。。"></a>未完待续。。。</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Dunteng Lin">
            
              <p class="site-author-name" itemprop="name">Dunteng Lin</p>
              <p class="site-description motion-element" itemprop="description">都会好的  总会有的</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dunteng Lin</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
